(this["webpackJsonpkern-projects-changelog"]=this["webpackJsonpkern-projects-changelog"]||[]).push([[0],{115:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(13),l=a.n(c),o=(a(61),a(62),a(63),a(10)),s=a.n(o),i=a(17),u=a(45),h=a(46),d=a(52),p=a(47),m=a(54),f=a(27),g=a.n(f),E={getProjects:function(){var e=Object(i.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",g.a.get("https://gitlab.com/api/v4/groups/3291864/projects",{method:"GET",headers:{"PRIVATE-TOKEN":"QPMEZZky8yBAkiQwQjT6"}}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),getProjectInfo:function(){var e=Object(i.a)(s.a.mark((function e(t,n,r){var c,l;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=a(82),l=c[r],n||(n="https://gitlab.com/api/v4/projects/".concat(t,"/merge_requests?state=merged&per_page=1000&target_branch=").concat(l)),e.abrupt("return",g.a.get(n,{method:"GET",headers:{"PRIVATE-TOKEN":"QPMEZZky8yBAkiQwQjT6"}}));case 4:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}()},v=a(118),y=a(119),j=a(49),k=a(124),b=a(125),w=a(120),P=a(123),I=a(121),S=a(28),x=a.n(S),D=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).state={projects:[],changes:[],selectedProjectId:void 0,filtered:[],search:"",isLoading:!1,hasError:!1,error:"",pages:[],showDetails:!0,fechaDesde:new Date,fechaHasta:new Date},a.filtrarPorFecha=function(){var e=a.state.changes.filter((function(e){var t=new Date(e.created_at);return t>=a.state.fechaDesde&&t<=a.state.fechaHasta}));a.setState({filtered:e})},a.executeScroll=function(){return e=a.myRef,window.scrollTo(0,e.current.offsetTop);var e},a.exctractInfo=function(){var e=Object(i.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=t.map((function(e){var t=/\[Ticket\]\:(\ *#*\w*)/,a=e.description.match(t);return a&&a.length>1&&(e.ticket=a[1]),t=/(\[Ejecutables\]:)([\ |\w|\.]*)/,(a=e.description.match(t))&&a.length>2&&(e.ejecutables=a[2]),t=/(\[Descripcion\]:)(.*)/,(a=e.description.match(t))&&a.length>2&&(e.descripcion_usr=a[2]),t=/(\[SP\]:)(.*)/,(a=e.description.match(t))&&a.length>2&&(e.stored_procedures=a[2]),t=/(\[Configuracion\]:)(.*)/,(a=e.description.match(t))&&a.length>2&&(e.configuraciones=a[2]),e})),a.setState({changes:t,filtered:t,isLoading:!1});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.myRef=r.a.createRef(),a}return Object(m.a)(t,e),Object(h.a)(t,[{key:"setPages",value:function(e){var t=[];e.split(",").forEach((function(e){var a=e.split(";");"first"===a[1].split("=")[1].replace('"',"").replace('"',"")&&t.push({id:0,url:a[0].replace('"',"").replace("<","").replace(">","")}),"prev"===a[1].split("=")[1].replace('"',"").replace('"',"")&&t.push({id:1,url:a[0].replace('"',"").replace("<","").replace(">","")}),"next"===a[1].split("=")[1].replace('"',"").replace('"',"")&&t.push({id:2,url:a[0].replace('"',"").replace("<","").replace(">","")}),"last"===a[1].split("=")[1].replace('"',"").replace('"',"")&&t.push({id:3,url:a[0].replace('"',"").replace("<","").replace(">","")})})),this.setState({pages:t.sort((function(e,t){return e.id-t.id}))})}},{key:"filter",value:function(e){var t=this;""!==e&&e?this.setState({search:e},(function(){var e=t.state.changes;e=e.filter((function(e){return e.title.includes(t.state.search)||e.description.includes(t.state.search)})),console.log(e),t.setState({filtered:e})})):this.setState({search:"",filtered:this.state.changes})}},{key:"componentDidMount",value:function(){this.getProjects(void 0)}},{key:"getProjects",value:function(){var e=this;E.getProjects().then((function(t){e.setState({projects:t.data})})).catch((function(e){return console.log(e)}))}},{key:"loadProjectInfo",value:function(e,t,a){var n=this;this.setState({isLoading:!0,selectedProjectId:e},(function(){E.getProjectInfo(e,t,a).then((function(e){console.log(e),n.setPages(e.headers.link),n.exctractInfo(e.data).then((function(){})),n.executeScroll()})).catch((function(e){console.log(e),n.setState({isLoading:!1,hasError:!0,error:e})}))}))}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement(v.a,{style:{marginLeft:"10rem"}},r.a.createElement("h1",null,"Proyectos"),r.a.createElement("h6",null,"Seleccione un proyecto para ver los cambios realizados por desarrollo"),r.a.createElement("br",null),r.a.createElement(y.a,null,this.state.projects.map((function(t){return r.a.createElement(j.a,{style:{padding:"2px"},key:t.id},r.a.createElement(k.a,{style:{width:"14rem",height:"14rem"}},r.a.createElement(k.a.Body,null,r.a.createElement(k.a.Title,null,t.name),r.a.createElement(k.a.Text,null,"Ultima actualizacion:"," ",new Date(t.last_activity_at).toLocaleDateString())),r.a.createElement(k.a.Footer,null,r.a.createElement(b.a,{variant:"danger",style:{margin:"0.1rem"},onClick:function(){e.loadProjectInfo(t.id,void 0,t.name)}},"Ver cambios"))))})))),r.a.createElement("hr",null),r.a.createElement("div",null,r.a.createElement("h1",{ref:this.myRef},this.state.projects.length>0&&this.state.selectedProjectId>=0?this.state.projects.find((function(t){return t.id===e.state.selectedProjectId})).name:void 0)),this.state.isLoading?r.a.createElement(w.a,{style:{margin:"40px"},animation:"grow",variant:"danger"}):this.state.changes.length>0?r.a.createElement(P.a,null,r.a.createElement(P.a.Group,{as:y.a,controlId:"searchInput"},r.a.createElement(P.a.Label,{column:!0,sm:2},"Buscar"),r.a.createElement(j.a,{sm:3},r.a.createElement(P.a.Control,{value:this.state.search,onKeyPress:function(e){console.log(e.key),"Enter"===e.key&&e.preventDefault()},onChange:function(t){return e.filter(t.target.value)},type:"text",placeholder:"Ingrese su busqueda"})),r.a.createElement(j.a,{sm:2},r.a.createElement(x.a,{value:this.state.fechaDesde,onChange:function(t){e.setState({fechaDesde:t})}})),r.a.createElement(j.a,{sm:2},r.a.createElement(x.a,{value:this.state.fechaHasta,onChange:function(t){e.setState({fechaHasta:t})}})),r.a.createElement(j.a,{sm:2},r.a.createElement(b.a,{onClick:function(){e.filtrarPorFecha()}},"Filtrar por fecha"))),r.a.createElement(b.a,{variant:"default",onClick:function(){return e.filter()}},"X Limpiar filtros")):void 0,r.a.createElement("br",null),this.state.filtered.length>0?r.a.createElement("div",null,r.a.createElement(I.a,{striped:!0,bordered:!0,hover:!0},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Fecha"),r.a.createElement("th",null,"Ticket"),r.a.createElement("th",null,"Ejecutables"),r.a.createElement("th",null,"Descripcion"),r.a.createElement("th",null,"SP"),r.a.createElement("th",null,"Configuraciones"),r.a.createElement("th",null,"Autor"))),r.a.createElement("tbody",null,this.state.filtered.map((function(e){return r.a.createElement("tr",{key:e.id},r.a.createElement("td",null,new Date(e.created_at).toLocaleDateString()),r.a.createElement("td",null,e.hasOwnProperty("ticket")?e.ticket.includes("#")?e.ticket.trim():"#"+e.ticket.trim():e.source_branch),r.a.createElement("td",null,e.hasOwnProperty("ejecutables")?e.ejecutables:""),r.a.createElement("td",null,r.a.createElement("b",null,e.title),r.a.createElement("br",null),e.hasOwnProperty("descripcion_usr")?e.descripcion_usr:e.description),r.a.createElement("td",null,e.hasOwnProperty("stored_procedures")?e.stored_procedures:"-"),r.a.createElement("td",null,e.hasOwnProperty("configuraciones")?e.configuraciones:"-"),r.a.createElement("td",null,e.author.name))}))))):void 0)}}]),t}(n.Component),_=a(122);var O=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(_.a,{bg:"light",style:{marginBottom:"40px"}},r.a.createElement(_.a.Brand,{href:"#"},r.a.createElement("span",null,"Control de versiones"))),r.a.createElement(D,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(113);l.a.render(r.a.createElement(O,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},56:function(e,t,a){e.exports=a(115)},61:function(e,t,a){},62:function(e,t,a){e.exports=a.p+"static/media/logo.5d5d9eef.svg"},63:function(e,t,a){},82:function(e,t){e.exports={"KernWebPatientDoctor.API":"master",KernLis:"release_1.4.5.X",KERN_MIC_PLUS:"release-1.0.x",KernIX:"master",KernValidadorOnline:"master"}}},[[56,1,2]]]);
//# sourceMappingURL=main.854e32ef.chunk.js.map